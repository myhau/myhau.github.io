<!DOCTYPE html>
<html>
<head>
  <title>Resume</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" type="text/javascript" charset="utf-8" ></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js" type="text/javascript" charset="utf-8" ></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/2.5.3/rx.lite.min.js" type="text/javascript" charset="utf-8" ></script>

  <link rel="stylesheet" href="resume.css">
  
  <link rel="stylesheet" href="resume_print.css" type="text/css" media="print" />

  <link rel="icon" type="image/ico" href="favicon.ico"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
  <script async defer>
    "use strict";

    function parsedMarkdownSource() { 
      return Rx.Observable.fromPromise($.ajax({
        url: "resume/resume.md",
        cache: false, // ?
      }))
      .map(function(resumeMarkdown) {
        marked.setOptions({
          renderer: new marked.Renderer(),
          gfm: true,
          tables: true, 
          breaks: true,
          pedantic: false,
          smartLists: true,
          smartypants: true,
          
        });
        return marked(resumeMarkdown);
      }); 
    }

    const SECOND = 1000;
    const refreshCvEvery = 1 * SECOND;

    function htmlSource() {
      return Rx.Observable.timer(0, refreshCvEvery)
        .flatMap(parsedMarkdownSource)
        .distinctUntilChanged();
    }
    
  </script>
</head>

<body>

<button id="pdf-export" style="float:right" onclick="window.print();">PDF</button>
<!-- <button id="json-export" style="float:right">JSON</button> -->

<div id="cv" style="padding-left:15%; padding-right:15%">
  Loading.....
</div>

</body>

<!-- after document loaded -->
<script>
  "use strict";
  htmlSource().subscribe(function(htmlMd) {
    $("#cv").html(htmlMd);
  });

  $("#pdf-export").on("click", function(e) {
    e.preventDefault();
  });
  $("#json-export").on("click", function(e) {
    e.preventDefault();
  });
</script>


</html>
